---
title: "Group Project 7-- Jayne, Olivia, Sarah"
subtitle: "Biology 368/664 Bucknell University"
output: html_notebook
author: Prof. Ken Field
date: 9 Feb 2022
---

```{r Load Libraries, include=FALSE}
# Load other packages here.
if (!require("datasauRus")) install.packages("datasauRus"); library(datasauRus)
if (!require("tidyverse")) install.packages("tidyverse"); library(tidyverse)
if (!require("cowplot")) install.packages("cowplot"); library(cowplot)
```

This project will require you to develop a tutorial to teach Bucknell students how to use R for graphing and data analysis. 

## Target Audience

Discuss with your group the target audience for the tutorial. 
Examples could be one of the new core Biology classes, another 300-level course (not 364), or a research group. 

```{r echo=FALSE}

```

## Groups

You will work with the same groups as for the Homework 2 Peer review. 

Our target audience is an upper level cancer biology class that has knowledge about R but isn't very experienced with using it.

Here we will explore the TARGET neuroblastoma data to gain insights about genetics and risk factor related to neuroblastoma.  Neuroblastoma is the most common extracranial solid cancer in children.  The 5 year survival rate has increased to ~50% with recent developments in immunotherapy and other novel treatments but this statistic begs the need for additional research and analysis.  One way to gain insights that might be translatable to the clinic is delving into patient data to uncover important patterns that might point towards ways to refine percision medicine approaches for neuroblastoma (Matthay, 2016).

MYCN is an important oncogene in neuroblastoma.  Focal amplification of MYCN is seen in some of the most aggressive cases and amplification marks 20-30% of total cases. 


Here we read in the TARGET neuroblastoma data.  White space in the dataframe was removed using the "trim_ws" code.  You can first assess the success of the data import by looking at the first 6 rows of the dataframe using the "head()" function.  The structure of the dataframe was assessed using the "str()" function.  This informs us about the coding of each column and the contents of each column (e.g. there is a race indicating patient gender and the data is coded as a character).  
```{r loading in TARGET data}

neuroblastoma <- read_csv("neuroblastoma.csv", trim_ws = TRUE)
head(neuroblastoma)
str(neuroblastoma)

```
It's time to clean up the data.  Work in R is A LOT easier when you are working with a clean and filtered dataframe.  Once we have explored the data and decide what question are god questions to ask, we will remove irrelevant columns or filter by rows that include certain responses. For now, we see that there is a diagnosis category variable. We can use the "table()" function by specifying the data set and variable to see all recorded responses for diagnostic category.  The majority of the responses are for neuroblastoma, which is the diagnosis type we are interested in, while 157 patients had unknown or ganglioneuroblastoma diagnoses.  We will filter our dataset, creating a new one (NBOnly) that only includes neuroblastoma diagnoses.  We can check the success of the filter by using the head() function again and can make sure that the number of rows (using nrows()) matches the number of pateints that we found had that diagnsois when we applied the table() function. 463! That checks out.  
```{r Filtering}
table(neuroblastoma$Diagnostic_Category)
NBOnly<-filter(neuroblastoma, Diagnostic_Category=="Neuroblastoma")
head(NBOnly)
nrow(NBOnly)
```
One Questin we might want to consider could be how MYCN amplification effects survival.  When we looked at the structure, we saw that there is a column that has information about the vital status of the patient. We can make a separate dataframe with only the patients who who died and and compare the amount of patients that 
```{r}
amp<- filter(NBOnly, MYCN=="Amplified")
nonamp<- filter(NBOnly, MYCN=="Not Amplified")
head(amp)
head(nonamp)
```

```{r}
table(amp$Vital_Status)
table(nonamp$Vital_Status)
```

```{r}
dead<- filter(NBOnly, Vital_Status=="Dead")
head(dead)
DeadOrder<- arrange(dead, Overall_Survival_Time_in_Days)
head(DeadOrder, 25)
tail(DeadOrder, 25)
```

Is there a relationship between gender and days of survival??
```{r}
table(dead$Gender)
alive<- filter(NBOnly, Vital_Status=="Alive")
head(alive)
table(alive$Gender)
```



Does the age at diagnosis correlate with the days of survival??
```{r}
summary(dead$Age_Diagnosis)
summary(dead$Overall_Survival_Time_in_Days)
dead<-arrange(dead, Age_Diagnosis)
head(dead, 25)
tail(dead, 25)
```

Do children <18 months at diagnosis have a higher survival rate than children 18+months at diagnosis? 
```{r}
Less18<-filter(NBOnly, Age_Diagnosis<550)
table(Less18$Vital_Status)
Greater18<-filter(NBOnly, Age_Diagnosis>=550)
table(Greater18$Vital_Status)
```


## Grading

Each student will be expected to complete the following tasks to earn 85% of the points available for this assignment (21/25).

- Identify and obtain suitable dataset
- Use a Github repository and version control to collaborate on the project
- Spend 4-6 hours preparing, coding, and testing tutorial
  + Data exploration
  + Data visualization
  + Hypothesis testing
- Present tutorial in class
- Provide public archive suitable for sharing to students/faculty

Tutorials from previous classes can be viewed at our public github site: https://github.com/Bucknell-Biol364

Each group should use an *Acknowledgements* section to document the participation of each member and the collaboration within and between groups.

Additional credit will be awarded for providing assistance to other groups and for the development of a tutorial that goes beyond the minimal expectations listed above.

## Sample Dataset

One of the possible datasets to use for the tutorial can be found in the datasauRus package.

```{r}
datasaurus_dozen %>% 
  group_by(dataset) %>% 
  summarize(
      mean_x    = mean(x),
      mean_y    = mean(y),
      std_dev_x = sd(x),
      std_dev_y = sd(y),
      corr_x_y  = cor(x, y)
      )
```

Boxplots of either the x or the y value show that there is something strange going on.

```{r}
ggplot(datasaurus_dozen, aes(x = x, colour = dataset))+
    geom_boxplot()+
    theme_void()+
    theme(legend.position = "none")+
    facet_wrap(~dataset, ncol = 3)
```

```{r}
ggplot(datasaurus_dozen, aes(x = y, colour = dataset))+
    geom_boxplot()+
    theme_void()+
    theme(legend.position = "none")+
    facet_wrap(~dataset, ncol = 3)
```

But you have to visualize all of the data with a scatter plot to really see the patterns.

```{r fig.height=12, fig.width=9}
  ggplot(datasaurus_dozen, aes(x = x, y = y, colour = dataset))+
    geom_point()+
    theme_void()+
    theme(legend.position = "none")+
    facet_wrap(~dataset, ncol = 3)
```

And did you notice the code in the {r} codechunk header that controlled the size of the output in the Rmd? Pretty neat trick!

And here are two versions of the data that you could use in your data visualization tutorial. 
To use them you would probably want to change the names of the datasets and also make x and y more meaningful. 
Then save them as a csv or tsv to be imported later for your tutorial. 

```{r}
datasaurus_long <- datasaurus_dozen
datasaurus_wide <- datasaurus_dozen_wide
head(datasaurus_long)
head(datasaurus_wide)
```

# Acknowledgements

DatasauRus package and description below: Stephanie Locke https://github.com/jumpingrivers/datasauRus

The datasauRus package wraps the awesome Datasaurus Dozen dataset, which contains 13 sets of x-y data. Each sub-dataset has five statistics that are (almost) the same in each case. (These are the mean of x, mean of y, standard deviation of x, standard deviation of y, and Pearson correlation between x and y). However, scatter plots reveal that each sub-dataset looks very different. The dataset is intended to be used to teach students that it is important to plot their own datasets, rather than relying only on statistics.

The Datasaurus was created by Alberto Cairo in this great [blog post](http://www.thefunctionalart.com/2016/08/download-datasaurus-never-trust-summary.html).

He's been subsequently made even more famous in the paper [Same Stats, Different Graphs: Generating Datasets with Varied Appearance and Identical Statistics through Simulated Annealing](https://www.autodeskresearch.com/publications/samestats) by Justin Matejka and George Fitzmaurice.

In the paper, Justin and George simulate a variety of datasets that the same summary statistics to the Datasaurus but have very different distributions. 

This package also makes these datasets available for use as an advanced [Anscombe's Quartet](https://en.wikipedia.org/wiki/Anscombe%27s_quartet), available in R as `anscombe`.
